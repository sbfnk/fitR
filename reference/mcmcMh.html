<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Metropolis-Hasting MCMCda — mcmcMh • fitR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Metropolis-Hasting MCMCda — mcmcMh"><meta property="og:description" content="Run nIterations of a Metropolis-Hasting MCMC to sample from the
target distribution using a gaussian proposal kernel.
Two optional optimizations are also implemented: truncated gaussian proposal
(to match the support of the target distribution, i.e. boundary of the
parameters) and adaptative gaussian proposal (to match the size and the shape
of the target distribution)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fitR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Metropolis-Hasting MCMCda</h1>
    
    <div class="hidden name"><code>mcmcMh.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Run <code>nIterations</code> of a Metropolis-Hasting MCMC to sample from the
target distribution using a gaussian proposal kernel.
Two optional optimizations are also implemented: truncated gaussian proposal
(to match the support of the target distribution, i.e. boundary of the
parameters) and adaptative gaussian proposal (to match the size and the shape
of the target distribution).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mcmcMh</span><span class="op">(</span></span>
<span>  <span class="va">target</span>,</span>
<span>  <span class="va">initTheta</span>,</span>
<span>  proposalSd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">nIterations</span>,</span>
<span>  covmat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="cn">NULL</span>, upper <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>  adaptSizeStart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptSizeCooling <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  adaptShapeStart <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adaptShapeStop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  printInfoEvery <span class="op">=</span> <span class="va">nIterations</span><span class="op">/</span><span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  maxScalingSd <span class="op">=</span> <span class="fl">50</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>target</dt>
<dd><p><span style="R">R</span>-function that takes a single argument: <code>theta</code> (named
  numeric vector of parameter values) and returns a list of 2 elements:</p><ul><li><p><code>logDensity</code> the logged value of the target density, evaluated at
  <code>theta</code>.</p></li>
<li><p><code>trace</code> a named numeric vector of values to be printed in the
  <code>trace</code> data.frame returned by <code>mcmcMh</code>.</p></li>
</ul></dd>


<dt>initTheta</dt>
<dd><p>named vector of initial parameter values to start the
chain.</p></dd>


<dt>proposalSd</dt>
<dd><p>vector of standard deviations. If this is given and covmat
is not, a diagonal matrix will be built from this to use as covariance
matrix of the multivariate Gaussian proposal distribution. By default, this
is set to <code>initTheta/10</code>.</p></dd>


<dt>nIterations</dt>
<dd><p>number of iterations to run the MCMC chain.</p></dd>


<dt>covmat</dt>
<dd><p>named numeric covariance matrix of the multivariate Gaussian
proposal distribution. Must have named rows and columns with at least all
estimated theta. If <code>proposalSd</code> is given, this is ignored.</p></dd>


<dt>limits</dt>
<dd><p>limits for the - potentially truncated - multi-variate normal
  proposal distribution of the MCMC. Contains 2 elements:</p><ul><li><p><code>lower</code> named numeric vector. Lower truncation points in each
  dimension of the Gaussian proposal distribution. By default they are set to
  <code>-Inf</code>.</p></li>
<li><p><code>upper</code> named numeric vector. Upper truncation points in each
  dimension of the Gaussian proposal distribution. By default they are set to
  <code>Inf</code>.</p></li>
</ul></dd>


<dt>adaptSizeStart</dt>
<dd><p>number of iterations to run before adapting the size
of the proposal covariance matrix (see note below). Set to NULL (default)
if size is not to be adapted.</p></dd>


<dt>adaptSizeCooling</dt>
<dd><p>cooling factor for the scaling factor of the
covariance matrix during size adaptation (see note below).</p></dd>


<dt>adaptShapeStart</dt>
<dd><p>number of accepted jumps before adapting the shape of
the proposal covariance matrix (see note below). Set to NULL (default) if
shape is not to be adapted</p></dd>


<dt>adaptShapeStop</dt>
<dd><p>number of iterations to run with adaptations
of the shape of the proposal covariance matrix  before stopping. Se
to NULL (default) if never to stop.</p></dd>


<dt>printInfoEvery</dt>
<dd><p>frequency of information on the chain: acceptance
rate and state of the chain. Default value to <code>nIterations/100</code>. Set
to <code>NULL</code> to avoid any info.</p></dd>


<dt>verbose</dt>
<dd><p>logical. If <code>TRUE</code>, information are printed.</p></dd>


<dt>maxScalingSd</dt>
<dd><p>numeric. Maximum value for the scaling factor of the
covariance matrix. Avoid too high values for the scaling factor, which
might happen due to the exponential update scheme. In this case, the
covariance matrix becomes too wide and the sampling from the truncated
proposal kernel becomes highly inefficient</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a list with 3 elements:</p><ul><li><p><code>trace</code> a <code>data.frame</code>. Each row contains a state of the
  chain (as returned by <code>target</code>, and an extra column for the
  logDensity).</p></li>
<li><p><code>acceptanceRate</code> acceptance rate of the MCMC chain.</p></li>
<li><p><code>covmatProposal</code> last covariance matrix used for proposals.</p></li>
</ul></div>
    <div id="note">
    <h2>Note</h2>
    <p>The size of the proposal covariance matrix is adapted using the
  following formulae: $$\Sigma_{n+1}=\sigma_n * \Sigma_n$$ with
  \(\sigma_n=\sigma_{n-1}*exp(\alpha^n*(acc - 0.234))\), where \(\alpha\)
  is equal to <code>adaptSizeCooling</code> and \(acc\) is the acceptance rate
  of the chain.</p>
<p>The shape of the proposal covariance matrix is adapted using the following
  formulae: $$\Sigma_{n+1}=2.38^2/d * \Sigma_n$$ with \(\Sigma_n\) the
  empirical covariance matrix and \(d\) is the number of estimated
  parameters in the model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Roberts GO, Rosenthal JS. Examples of adaptive MCMC. Journal of
  Computational and Graphical Statistics. Taylor &amp; Francis;
  2009;18(2):349-67.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Anton Camacho, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

